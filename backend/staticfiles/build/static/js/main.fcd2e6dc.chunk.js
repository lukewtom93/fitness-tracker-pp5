(this.webpackJsonpmoments=this.webpackJsonpmoments||[]).push([[0],{23:function(e,t,c){},43:function(e,t,c){},46:function(e,t,c){"use strict";c.r(t);var r=c(0),s=c.n(r),a=c(16),n=c.n(a),o=(c(23),c(2)),l=c(5),i=c(17);const j="access",d="refresh",b=c.n(i).a.create({baseURL:"https://fitness-tracker-pp5-52ea60f889f7.herokuapp.com/api"});b.interceptors.request.use((e=>{const t=localStorage.getItem(j);return t&&(e.headers.Authorization=`Bearer ${t}`),e}),(e=>Promise.reject(e)));var h=b,u=(c(43),c(3));var O=()=>Object(u.jsx)("div",{className:"loading-containerr",children:Object(u.jsx)("div",{className:"loader"})});var m=function(e){let{method:t}=e;const[c,s]=Object(r.useState)(""),[a,n]=Object(r.useState)(""),[l,i]=Object(r.useState)(!1),b=Object(o.o)(),m="login"===t?"Login":"Register";return Object(u.jsxs)("form",{onSubmit:async e=>{i(!0),e.preventDefault();try{const e=await h.post("token/",{username:c,password:a});"login"===t?(localStorage.setItem(j,e.data.access),localStorage.setItem(d,e.data.refresh),b("/")):b("/login")}catch(r){alert(r)}finally{i(!1)}},className:"form-container",children:[Object(u.jsx)("h1",{children:"Hello"}),Object(u.jsx)("input",{className:"form-input",type:"text",value:c,onChange:e=>s(e.target.value),placeholder:"Username"}),Object(u.jsx)("input",{className:"form-input",type:"password",value:a,onChange:e=>n(e.target.value),placeholder:"Password"}),l&&Object(u.jsx)(O,{}),Object(u.jsx)("button",{className:"form-button",type:"submit",children:m})]})};var x=function(){return Object(u.jsx)(m,{route:"token/",method:"login"})};var g=function(){return Object(u.jsx)(m,{route:"profile/register/",method:"register"})};c(45);var p=function(){const[e,t]=Object(r.useState)(!0),[c,s]=Object(r.useState)([]),[a,n]=Object(r.useState)(""),[o,l]=Object(r.useState)("");Object(r.useEffect)((()=>{(async()=>{try{const e=await fetch("/api/calories/");if(!e.ok)throw new Error("Network response was not ok");const t=await e.json();s(t)}catch(e){console.error("Error fetching data:",e)}finally{t(!1)}})()}),[]);const i=c.reduce(((e,t)=>e+t.calories),0);return e?Object(u.jsx)("div",{children:"Loading..."}):Object(u.jsxs)("div",{className:"container mt-5",children:[Object(u.jsx)("h1",{className:"text-center mb-4",children:"Calorie Tracker"}),Object(u.jsx)("div",{className:"card p-4 mb-4",children:Object(u.jsxs)("div",{className:"row g-3",children:[Object(u.jsx)("div",{className:"col-md-6",children:Object(u.jsx)("input",{type:"text",className:"form-control",placeholder:"Food Item",value:a,onChange:e=>n(e.target.value)})}),Object(u.jsx)("div",{className:"col-md-4",children:Object(u.jsx)("input",{type:"number",className:"form-control",placeholder:"Calories",value:o,onChange:e=>l(e.target.value)})}),Object(u.jsx)("div",{className:"col-md-2",children:Object(u.jsx)("button",{className:"btn btn-primary w-100",onClick:async()=>{if(a&&o)try{const e=await fetch("/api/calories/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access")}`},body:JSON.stringify({food:a,calories:parseInt(o)})});if(!e.ok)throw new Error("Failed to add entry");const t=await e.json();s([...c,t]),n(""),l("")}catch(e){console.error("Error adding entry:",e)}},children:"Add"})})]})}),Object(u.jsxs)("div",{className:"card p-4",children:[Object(u.jsx)("h3",{className:"mb-3",children:"Calorie Entries"}),c.length>0?Object(u.jsxs)("table",{className:"table table-striped",children:[Object(u.jsx)("thead",{children:Object(u.jsxs)("tr",{children:[Object(u.jsx)("th",{children:"#"}),Object(u.jsx)("th",{children:"Food"}),Object(u.jsx)("th",{children:"Calories"}),Object(u.jsx)("th",{children:"Actions"})]})}),Object(u.jsx)("tbody",{children:c.map(((e,t)=>Object(u.jsxs)("tr",{children:[Object(u.jsx)("td",{children:t+1}),Object(u.jsx)("td",{children:e.food}),Object(u.jsx)("td",{children:e.calories}),Object(u.jsx)("td",{children:Object(u.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>(async e=>{try{if(!(await fetch(`/api/calories/${e}/`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("access")}`}})).ok)throw new Error("Failed to delete entry");s(c.filter((t=>t.id!==e)))}catch(t){console.error("Error deleting entry:",t)}})(e.id),children:"Delete"})})]},t)))})]}):Object(u.jsx)("p",{className:"text-muted",children:"No entries yet. Add some food items!"})]}),Object(u.jsx)("div",{className:"mt-4 text-center",children:Object(u.jsxs)("h4",{children:["Total Calories: ",i]})})]})};var f=function(){return Object(u.jsxs)("div",{children:[Object(u.jsx)("h1",{children:"404 Not Found"}),Object(u.jsx)("p",{children:"The page you're looking for doesn't exist!"})]})},v=c(18);var y=function(e){let{children:t}=e;const[c,s]=Object(r.useState)(null),a=Object(r.useCallback)((async()=>{const e=localStorage.getItem(d);try{const t=await h.post("/token/refresh/",{refresh:e});200===t.status?(localStorage.setItem(j,t.data.access),s(!0)):s(!1)}catch(t){console.log(t),s(!1)}}),[]),n=Object(r.useCallback)((async()=>{const e=localStorage.getItem(j);if(!e)return void s(!1);Object(v.a)(e).exp<Date.now()/1e3?await a():s(!0)}),[a]);return Object(r.useEffect)((()=>{n().catch((()=>s(!1)))}),[n]),null===c?Object(u.jsx)("div",{children:"Loading..."}):c?t:Object(u.jsx)(l.b,{to:"/login"})};function N(){return localStorage.clear(),Object(u.jsx)(o.a,{to:"/login"})}function w(){return localStorage.clear(),Object(u.jsx)(g,{})}var S=function(){return Object(u.jsx)(l.a,{children:Object(u.jsxs)(o.d,{children:[Object(u.jsx)(o.b,{path:"/",element:Object(u.jsx)(y,{children:Object(u.jsx)(p,{})})}),Object(u.jsx)(o.b,{path:"/login",element:Object(u.jsx)(x,{})}),Object(u.jsx)(o.b,{path:"/logout",element:Object(u.jsx)(N,{})}),Object(u.jsx)(o.b,{path:"/register",element:Object(u.jsx)(w,{})}),Object(u.jsx)(o.b,{path:"*",element:Object(u.jsx)(f,{})})]})})};var k=e=>{e&&e instanceof Function&&c.e(3).then(c.bind(null,47)).then((t=>{let{getCLS:c,getFID:r,getFCP:s,getLCP:a,getTTFB:n}=t;c(e),r(e),s(e),a(e),n(e)}))};n.a.render(Object(u.jsx)(s.a.StrictMode,{children:Object(u.jsx)(S,{})}),document.getElementById("root")),k()}},[[46,1,2]]]);
//# sourceMappingURL=main.fcd2e6dc.chunk.js.map